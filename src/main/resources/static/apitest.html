<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
</head>
<body>
	<h2>Articles API tester</h2>
	<fieldset>
	<label>	아이디	</label>
	<input type="number" id="id" > <br>
	<label>	제목	</label>
	<input type="text" id="title" > <br>
	<label>	내용	</label>
	<textarea rows="3" cols="3" id="content"></textarea>
	</fieldset>
	<div id="output"></div>
	<ul>
	<li><a href="/api/articles" id="get">Article 목록 조회(Get)</a></li>
	<li><a href="/api/articles" id="getOne">1번 Article 조회(Get)</a></li>
	<li><a href="/api/articles" id="post">article 삽입</a></li>
	</ul>
	
	
	<script>
	const outputEl = document.querySelector('#output');

	const aElList = document.querySelectorAll('a');
	aElList.forEach((aEl,i)=>{
		aEl.onclick = (e)=>{
			e.preventDefault();    // 기존 a tag 기능을 무력화
			//console.dir(aEl);
			
			switch(aEl.id){
			case 'get': 
				fetch(aEl.href)  // fetch(aEl.href,{method : 'GET'}) 
					.then(response=>response.json())
					.then(json=>{
						console.dir(json);
						outputEl.innerHTML=JSON.stringify(json)	
					
					})
					.catch(error=>console.dir(error))
				break;			
			case 'getOne': 
				const numId = document.querySelector('#id').value;
				fetch(aEl.href + "/" + numId) // fetch(aEl.href,{method : 'GET'}) 
					.then(response=>response.json())
					.then(json=>{
						console.dir(json);
						outputEl.innerHTML=JSON.stringify(json)	
					
					})
					.catch(error=>console.dir(error))
				break;		
			
			case 'post' :
				const titleEl = document.querySelector('#title').value;
				const contentEl = document.querySelector('#content').value;
				fetch('/api/articles', {
					  method: 'POST',
					  headers: {
					    'Content-Type': 'application/json'
					  },
					  body: JSON.stringify({
					    title: titleEl,
					    content: contentEl
					  })
					})
					.then(response=>response.json())
					.then(json=>{

					
					})
					.catch(error=>console.dir(error))
				break;
			}
			
			alert(aEl.id);
			
		}
	
	})
	
	
	</script>
</body>
</html>